{"version":3,"sources":["../../../src/api/elastic.js"],"names":["must","structPlain","data","query","bool","term","_type","concat","method","url","resp","code","hits","map","item","fetchLogListByContainer"],"mappings":";;;;;;;;;;;;;;;;sFAGO;AAAA,QAAwCA,IAAxC,uEAA+C,EAA/C;AAAA,QAAmDC,WAAnD,uEAAiE,KAAjE;AAAA;AAAA;AAAA;AAAA;AAAA;AACCC,gBADD,GACQ;AACXC,qBAAO;AACLC,sBAAM;AACJJ,wBAAM,CACJ;AACEK,0BAAM,EAACC,OAAO,gBAAR;AADR,mBADI;AADF;AADD;AADI,aADR;;;AAaLJ,iBAAKC,KAAL,CAAWC,IAAX,CAAgBJ,IAAhB,GAAuBE,KAAKC,KAAL,CAAWC,IAAX,CAAgBJ,IAAhB,CAAqBO,MAArB,CAA4BP,IAA5B,CAAvB;;AAbK;AAAA,mBAec,oBAAM;AACvBQ,sBAAQ,MADe;AAEvBC,qCAFuB;AAGvBP;AAHuB,aAAN,CAfd;;AAAA;AAeCQ,gBAfD;;AAAA,kBAqBDA,KAAKR,IAAL,CAAUS,IAAV,KAAmB,GArBlB;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAyBCC,gBAzBD,GAyBQF,KAAKR,IAAL,CAAUA,IAAV,CAAeU,IAAf,CAAoBA,IAzB5B;;AAAA,gBA0BAX,WA1BA;AAAA;AAAA;AAAA;;AAAA,6CA2BIW,IA3BJ;;AAAA;AAAA,6CA8BEA,KAAKC,GAAL,CAAS,UAACC,IAAD,EAAU;AACxB,qBAAO,2BAAgBA,IAAhB,CAAP;AACD,aAFM,CA9BF;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,G;;kBAAeC,uB;;;;;AAHtB;;;;AACA","file":"elastic.js","sourcesContent":["import axios from './base'\nimport {objectFlattened} from '@/util'\n\nexport async function fetchLogListByContainer (must = [], structPlain = false) {\n  const data = {\n    query: {\n      bool: {\n        must: [\n          {\n            term: {_type: 'fluentd-docker'}\n          }\n        ]\n      }\n    }\n  }\n\n  data.query.bool.must = data.query.bool.must.concat(must)\n\n  const resp = await axios({\n    method: 'POST',\n    url: `/elastic/_search`,\n    data\n  })\n\n  if (resp.data.code !== 200) {\n    return\n  }\n\n  const hits = resp.data.data.hits.hits\n  if (!structPlain) {\n    return hits\n  }\n\n  return hits.map((item) => {\n    return objectFlattened(item)\n  })\n}\n"]}
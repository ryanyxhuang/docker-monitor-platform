webpackJsonp([1],{"17DS":function(t,e){},"2PcU":function(t,e){},"4/hK":function(t,e){},"58pS":function(t,e){},"5o4V":function(t,e){},B5l1:function(t,e){},KBt4:function(t,e){},LDM6:function(t,e){},Mzzr:function(t,e){},NHnr:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("zL8q"),a=n.n(r),s=n("7+uW"),o={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("header",[e("h1",[this._v("Docker Monitor Platform")])])}]};var i={methods:{handleMenuRouter:function(t){console.log(t),this.$router.push({name:t})}}},c={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("aside",[n("el-menu",{staticClass:"aside-menu",attrs:{"default-active":"home","background-color":"#484D51","text-color":"#fff",router:!1,"active-text-color":"#5296CF"},on:{select:t.handleMenuRouter}},[n("el-menu-item",{attrs:{index:"home"}},[n("i",{staticClass:"el-icon-location-outline"}),t._v(" "),n("span",{attrs:{slot:"title"},slot:"title"},[t._v("首页")])]),t._v(" "),n("el-menu-item",{attrs:{index:"containersList"}},[n("i",{staticClass:"el-icon-more-outline"}),t._v(" "),n("span",{attrs:{slot:"title"},slot:"title"},[t._v("Containers")])]),t._v(" "),n("el-menu-item",{attrs:{index:"servicesList"}},[n("i",{staticClass:"el-icon-tickets"}),t._v(" "),n("span",{attrs:{slot:"title"},slot:"title"},[t._v("Services")])]),t._v(" "),n("el-menu-item",{attrs:{index:"stacksList"}},[n("i",{staticClass:"el-icon-document"}),t._v(" "),n("span",{attrs:{slot:"title"},slot:"title"},[t._v("Stacks")])]),t._v(" "),n("el-menu-item",{attrs:{index:"nodesList"}},[n("i",{staticClass:"el-icon-news"}),t._v(" "),n("span",{attrs:{slot:"title"},slot:"title"},[t._v("Swarm")])])],1)],1)},staticRenderFns:[]};var u={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"main"},[e("router-view")],1)},staticRenderFns:[]};var l={components:{MHeader:n("VU/8")(null,o,!1,function(t){n("Z/q7")},null,null).exports,MAside:n("VU/8")(i,c,!1,function(t){n("58pS")},null,null).exports,MMain:n("VU/8")(null,u,!1,function(t){n("B5l1")},null,null).exports}},d={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("m-header"),this._v(" "),e("div",{staticClass:"container"},[e("m-aside"),this._v(" "),e("m-main")],1)],1)},staticRenderFns:[]};var p=n("VU/8")(l,d,!1,function(t){n("zlJl")},null,null).exports,m=n("/ocq"),f=n("//Fk"),h=n.n(f),v=n("d7EF"),b=n.n(v),g=n("Xxa5"),_=n.n(g),k=n("exGp"),w=n.n(k),y={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"nodes-list"},[n("section",{staticClass:"card"},[n("h3",{staticClass:"sub-title"},[t._v("主机列表")]),t._v(" "),n("div",{staticClass:"action-bar"},[n("el-button",{attrs:{type:"primary"},on:{click:t.openEndpointDialog}},[t._v("\n        添加主机节点\n      ")])],1),t._v(" "),n("el-table",{staticStyle:{width:"100%"},attrs:{data:t.endpointList}},[n("el-table-column",{attrs:{type:"selection"}}),t._v(" "),n("el-table-column",{attrs:{prop:"name",label:"Name","show-overflow-tooltip":!0}}),t._v(" "),n("el-table-column",{attrs:{prop:"dockerUrl",label:"Docker Url",width:"300"}}),t._v(" "),n("el-table-column",{attrs:{prop:"promUrl",label:"Promethus Url",width:"300"}}),t._v(" "),n("el-table-column",{attrs:{label:"操作",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(n){return n.preventDefault(),t.setCurrentEndpoint(e.row.name)}}},[t._v("\n            设为当前监控节点\n          ")])]}}])})],1)],1)])},staticRenderFns:[]};var x=n("VU/8")({props:["endpointList"],methods:{openEndpointDialog:function(){var t=this;this.$prompt("节点ip","创建节点",{confirmButtonText:"确定",cancelButtonText:"取消",inputErrorMessage:"ip格式错误"}).then(function(e){var n=e.value;t.$emit("createEndpoint",n)})},setCurrentEndpoint:function(t){this.$emit("setCurrentEndpoint",t)}}},y,!1,function(t){n("Mzzr")},null,null).exports,C={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("ul",{staticClass:"base-info"},t._l(t.info,function(e,r){return n("li",{key:r},[n("div",{staticClass:"name"},[t._v(t._s(r))]),t._v(" "),n("div",{staticClass:"value"},[t._v(t._s(e))])])}),0)},staticRenderFns:[]};var S={props:["endpointInfo","dataAnalysis"],components:{Info:n("VU/8")({props:["info"],computed:{},methods:{}},C,!1,function(t){n("KBt4")},null,null).exports},methods:{}},I={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"endpoint-info"},[n("section",{staticClass:"card"},[n("h3",{staticClass:"sub-title"},[t._v("当前主机信息")]),t._v(" "),n("div",{staticClass:"endpoint-info-main"},[n("ul",{staticClass:"endpoint-info-base"},t._l(t.endpointInfo,function(e,r){return n("li",{key:r},[n("div",{staticClass:"name"},[t._v(t._s(r))]),t._v(" "),n("div",{staticClass:"value"},[t._v(t._s(e))])])}),0),t._v(" "),t.dataAnalysis?n("ul",{staticClass:"endpoint-info-count"},[n("li",[n("div",[t._v(t._s(t.dataAnalysis.stacksNum))]),t._v("Stacks")]),t._v(" "),n("li",[n("div",[t._v(t._s(t.dataAnalysis.servicesNum))]),t._v("Services")]),t._v(" "),n("li",[n("div",[t._v(t._s(t.dataAnalysis.containersNum))]),t._v("Containers")])]):t._e()])])])},staticRenderFns:[]};var U=n("VU/8")(S,I,!1,function(t){n("VHhA")},null,null).exports,E={props:["endpoint","containersWithHignNetIO","containersWithHignDiskIO","containersWithHighCPUUsage","containersWithHighMemoryUsage"],data:function(){return{monitorType:"metrics",dockerMonitorCategory:"containersWithHignNetIO"}},computed:{tableData:function(){return this.$props[this.dockerMonitorCategory]},promUrl:function(){var t=this.$props.endpoint;if(!t)return null;var e=t.promUrl.split(":"),n=e[e.length-2];return this.$props.grafanaUrl||n+":3000"},promNodeUrl:function(){return"http://"+this.promUrl+"/d/BPlb-Sgik/docker-swarm-nodes?refresh=30s&orgId=1"},promServiceUrl:function(){return"http://"+this.promUrl+"/d/zr_baSRmk/docker-swarm-services?refresh=30s&orgId=1"}},methods:{handleMonitorTypeChange:function(t){},handleDockerMonitorCategoryChange:function(t){this.tableData=this.$props[t.name]}}},D={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"monitor-summary"},[n("section",{staticClass:"card"},[n("h3",{staticClass:"sub-title"},[t._v("监控")]),t._v(" "),n("el-tabs",{attrs:{type:"card"},on:{"tab-click":t.handleMonitorTypeChange},model:{value:t.monitorType,callback:function(e){t.monitorType=e},expression:"monitorType"}},[n("el-tab-pane",{staticStyle:{padding:"0 16px"},attrs:{label:"  指标监控  ",name:"metrics"}},[n("el-tabs",{attrs:{de:""},on:{"tab-click":t.handleDockerMonitorCategoryChange},model:{value:t.dockerMonitorCategory,callback:function(e){t.dockerMonitorCategory=e},expression:"dockerMonitorCategory"}},[n("el-tab-pane",{attrs:{label:"高网络IO容器",name:"containersWithHignNetIO"}}),t._v(" "),n("el-tab-pane",{attrs:{label:"高磁盘IO容器",name:"containersWithHignDiskIO"}}),t._v(" "),n("el-tab-pane",{attrs:{label:"高CPU使用容器",name:"containersWithHighCPUUsage"}}),t._v(" "),n("el-tab-pane",{attrs:{label:"高内存使用容器",name:"containersWithHighMemoryUsage"}})],1),t._v(" "),n("el-table",{staticStyle:{width:"100%"},attrs:{size:"small",data:t.tableData,"max-height":"720"}},[n("el-table-column",{attrs:{label:"Name","show-overflow-tooltip":!0},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n              "+t._s(e.row.metric.name)+"\n            ")]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"UsageAmount",width:"400","show-overflow-tooltip":!0},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n              "+t._s(e.row.value[1])+"\n            ")]}}])})],1)],1),t._v(" "),n("el-tab-pane",{attrs:{label:" Swarm集群服务监控 ",name:"services"}},[n("iframe",{attrs:{src:t.promNodeUrl,height:"720",width:"100%",frameborder:"0",scrolling:"0"}})]),t._v(" "),n("el-tab-pane",{attrs:{label:" Swarm集群节点监控 ",name:"nodes"}},[n("iframe",{attrs:{src:t.promServiceUrl,height:"720",width:"100%",frameborder:"0",scrolling:"0"}})])],1)],1)])},staticRenderFns:[]};var L,M,$,A,F=n("VU/8")(E,D,!1,function(t){n("q6Q7")},null,null).exports,O=n("mtWM"),R=n.n(O).a.create({baseURL:"http://192.16.1.250:8081"}),T=n("lbHh"),N=n.n(T),P=(L=w()(_.a.mark(function t(){var e;arguments.length>0&&void 0!==arguments[0]&&arguments[0];return _.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,R.get("/endpoint/"+j());case 2:if(e=t.sent,console.log("resp",e),200!==e.data.code){t.next=6;break}return t.abrupt("return",e.data.data);case 6:case"end":return t.stop()}},t,this)})),function(){return L.apply(this,arguments)}),H=(M=w()(_.a.mark(function t(){var e;arguments.length>0&&void 0!==arguments[0]&&arguments[0];return _.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,R.get("/endpoint");case 2:if(200!==(e=t.sent).data.code){t.next=5;break}return t.abrupt("return",e.data.data);case 5:case"end":return t.stop()}},t,this)})),function(){return M.apply(this,arguments)}),B=($=w()(_.a.mark(function t(){var e;arguments.length>0&&void 0!==arguments[0]&&arguments[0];return _.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,R.get("/proxy/docker/info");case 2:if(200!==(e=t.sent).data.code){t.next=5;break}return t.abrupt("return",e.data.data);case 5:case"end":return t.stop()}},t,this)})),A=w()(_.a.mark(function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return _.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,R({method:"POST",url:"/endpoint",data:{name:n.name||n.ip,ip:n.ip,dockerUrl:n.ip+":2375",promUrl:n.ip+":9090"}});case 2:if(200===(e=t.sent).data.code){t.next=5;break}return t.abrupt("return",e.data.message);case 5:case"end":return t.stop()}},t,this)})),function(){return A.apply(this,arguments)});function j(){return N.a.get("currentEndpoint")||"local"}var W=n("Gu7T"),V=n.n(W),q=n("woOf"),z=n.n(q),G=n("pFYg"),K=n.n(G);function X(t){return function t(e,n){var r=Array.isArray(e)?[]:{};for(var a in e){var s=n?n+"."+a:a;e.hasOwnProperty(a)&&("object"===K()(e[a])?z()(r,r,t(e[a],s)):r[s]=e[a])}return r}(t,"")}function J(t,e){var n=[];for(var r in t)t.hasOwnProperty(r)&&(e===r&&n.push(t[r]),"object"===K()(t[r])&&n.push.apply(n,V()(J(t[r],e))));return n}function Q(t){return btoa(encodeURIComponent(t).replace(/%([0-9A-F]{2})/g,function(t,e){return String.fromCharCode("0x"+e)}))}function Y(t,e){return(t=Number(t))<102.4?t.toFixed(e)+"B/s":t<104857.6?(t/1024).toFixed(e)+"KB/s":t<107374182.4?(t/1048576).toFixed(e)+"MB/s":(t/1073741824).toFixed(e)+"GB/s"}var Z=function(){var t=w()(_.a.mark(function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return _.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,R({method:"POST",url:"/endpoint/"+j()+"/prom/api/v1/query",data:{query:'sum(rate(container_network_receive_bytes_total{id=~"/docker/.*"}['+n.promInterval+']) + rate(container_network_transmit_bytes_total{id=~"/docker/.*"}['+n.promInterval+"])) by (name) >"+n.netIOThreshold},headers:{Authorization:"Basic "+Q(n.promAccount)}});case 2:if(200!==(e=t.sent).data.code){t.next=5;break}return t.abrupt("return",e.data.data.result.map(function(t){return t.value[1]&&(t.value[1]=Y(t.value[1],2)),t}));case 5:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),tt=function(){var t=w()(_.a.mark(function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return _.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,R({method:"POST",url:"/endpoint/"+j()+"/prom/api/v1/query",data:{query:'sum(rate(container_fs_io_current{id=~"/docker/.*"}['+n.promInterval+"])) by (name) > "+n.diskIOThreshold},headers:{Authorization:"Basic "+Q(n.promAccount)}});case 2:if(200!==(e=t.sent).data.code){t.next=5;break}return t.abrupt("return",e.data.data.result.map(function(t){return t.value[1]&&(t.value[1]=Y(t.value[1],2)),t}));case 5:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),et=function(){var t=w()(_.a.mark(function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return _.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return console.log(n.promInterval,n.cpuUsageThreshold,'sum(irate(container_cpu_usage_seconds_total{id=~"/docker/.*"}['+n.promInterval+"])) by (name) * 100 > "+n.cpuUsageThreshold),t.next=3,R({method:"POST",url:"/endpoint/"+j()+"/prom/api/v1/query",data:{query:'sum(irate(container_cpu_usage_seconds_total{id=~"/docker/.*"}['+n.promInterval+"])) by (name) * 100 > "+n.cpuUsageThreshold},headers:{Authorization:"Basic "+Q(n.promAccount)}});case 3:if(200!==(e=t.sent).data.code){t.next=6;break}return t.abrupt("return",e.data.data.result.map(function(t){return t.value[1]=Number(t.value[1]).toFixed(2)+"%",t}));case 6:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),nt=function(){var t=w()(_.a.mark(function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return _.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,R({method:"POST",url:"/endpoint/"+j()+"/prom/api/v1/query",headers:{Authorization:"Basic "+Q(n.promAccount)},data:{query:'avg_over_time(container_memory_usage_bytes{id=~"/docker/.*"}['+n.promInterval+"]) > "+n.memoryUsageThreshold}});case 2:if(200!==(e=t.sent).data.code){t.next=5;break}return t.abrupt("return",e.data.data.result.filter(function(t){return t.metric&&t.metric.name}).map(function(t){var e,n;return t.value[1]=(e=t.value[1],n=2,(e=Number(e))<102.4?e.toFixed(n)+"B/s":e<104857.6?(e/1024).toFixed(n)+"KB/s":e<107374182.4?(e/1048576).toFixed(n)+"MB/s":(e/1073741824).toFixed(n)+"GB/s"),t}));case 5:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),rt=function(){var t=w()(_.a.mark(function t(){var e;arguments.length>0&&void 0!==arguments[0]&&arguments[0];return _.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,R.get("/setting");case 2:if(200!==(e=t.sent).data.code){t.next=5;break}return t.abrupt("return",e.data.data);case 5:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),at=function(){var t=w()(_.a.mark(function t(){var e;arguments.length>0&&void 0!==arguments[0]&&arguments[0];return _.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,R.get("/endpoint/"+j()+"/docker/services");case 2:if(200!==(e=t.sent).data.code){t.next=5;break}return t.abrupt("return",e.data.data);case 5:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),st=function(){var t=w()(_.a.mark(function t(){var e;arguments.length>0&&void 0!==arguments[0]&&arguments[0];return _.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,R.get("/endpoint/"+j()+"/docker/containers/json");case 2:if(200!==(e=t.sent).data.code){t.next=5;break}return t.abrupt("return",e.data.data);case 5:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),ot={components:{EndpointsList:x,EndpointInfo:U,MonitorSummary:F},data:function(){return{nodesList:null,containersWithHignNetIO:[],containersWithHignDiskIO:[],containersWithHighCPUUsage:[],containersWithHighMemoryUsage:[],currentEndpointInfo:null,endpointList:[],settings:{},dataAnalysis:{}}},mounted:function(){var t=this;return w()(_.a.mark(function e(){return _.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.fetchSettings();case 2:t.settings=e.sent,t.loadData(),t.loadAnalysis();case 5:case"end":return e.stop()}},e,t)}))()},methods:{loadData:function(){var t=this;return w()(_.a.mark(function e(){var n,r,a,s,o,i,c,u;return _.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.a.all([Z(t.settings),tt(t.settings),et(t.settings),nt(t.settings),P(),H()]);case 2:n=e.sent,r=b()(n,6),a=r[0],s=r[1],o=r[2],i=r[3],c=r[4],u=r[5],t.containersWithHignNetIO=a,t.containersWithHignDiskIO=s,t.containersWithHighCPUUsage=o,t.containersWithHighMemoryUsage=i,t.currentEndpointInfo=c,t.endpointList=u;case 16:case"end":return e.stop()}},e,t)}))()},fetchSettings:function(){var t=this;return w()(_.a.mark(function e(){var n;return _.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n={},t.next=3,rt();case 3:return t.sent.forEach(function(t){n[t.key]=t.value}),t.abrupt("return",n);case 6:case"end":return t.stop()}},e,t)}))()},loadAnalysis:function(){var t=this;return w()(_.a.mark(function e(){var n,r,a,s,o,i;return _.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.a.all([at(),st()]);case 2:n=e.sent,r=b()(n,2),a=r[0],s=r[1],o=[],i=!1,a.forEach(function(t){var e=t.Spec.Labels["com.docker.stack.namespace"];o.forEach(function(n){e===n.name&&(i=!0,n.services.push(t))}),!i&&e&&o.push({id:t.Id,name:e,services:[t],type:"swarm"})}),t.dataAnalysis.stacksNum=o.length,t.dataAnalysis.containersNum=s.length,t.dataAnalysis.servicesNum=a.length;case 12:case"end":return e.stop()}},e,t)}))()},createEndpoint:function(t){var e=this;return w()(_.a.mark(function n(){var r;return _.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,B({ip:t});case 2:if(r=n.sent){n.next=10;break}return e.$message.success("节点[ip: "+t+"]创建成功"),n.next=7,H();case 7:e.endpointList=n.sent,n.next=11;break;case 10:e.$message.error("节点创建失败 "+r);case 11:case"end":return n.stop()}},n,e)}))()},setCurrentEndpoint:function(t){var e;e=t,N.a.set("currentEndpoint",e),this.loadData()}}},it={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"home"},[n("monitor-summary",{staticClass:"monitor-info",attrs:{endpoint:t.currentEndpointInfo,containersWithHignNetIO:t.containersWithHignNetIO,containersWithHignDiskIO:t.containersWithHignDiskIO,containersWithHighCPUUsage:t.containersWithHighCPUUsage,containersWithHighMemoryUsage:t.containersWithHighMemoryUsage}}),t._v(" "),n("endpoint-info",{staticClass:"endpoint-info",attrs:{endpointInfo:t.currentEndpointInfo,dataAnalysis:t.dataAnalysis}}),t._v(" "),n("endpoints-list",{staticClass:"endpoint-list",attrs:{endpointList:t.endpointList},on:{createEndpoint:t.createEndpoint,setCurrentEndpoint:t.setCurrentEndpoint}})],1)},staticRenderFns:[]};var ct=n("VU/8")(ot,it,!1,function(t){n("XQ4a")},null,null).exports;function ut(t,e){var n={"M+":t.getMonth()+1,"d+":t.getDate(),"h+":t.getHours(),"m+":t.getMinutes(),"s+":t.getSeconds(),"q+":Math.floor((t.getMonth()+3)/3),S:t.getMilliseconds()};for(var r in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(t.getFullYear()+"").substr(4-RegExp.$1.length))),n)new RegExp("("+r+")").test(e)&&(e=e.replace(RegExp.$1,1===RegExp.$1.length?n[r]:("00"+n[r]).substr((""+n[r]).length)));return e}var lt={components:{},data:function(){return{containersList:null}},mounted:function(){var t=this;return w()(_.a.mark(function e(){var n;return _.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,st();case 2:n=e.sent,t.containersList=n.map(function(t){return{id:t.Id,name:t.Names[0],state:t.State,stack:t.Labels["com.docker.stack.namespace"],image:t.Image,created:ut(new Date(1e3*t.Created),"yyyy-MM-dd hh:mm:ss"),endpoint:J(t.NetworkSettings.Networks,"EndpointID")}});case 4:case"end":return e.stop()}},e,t)}))()},methods:{routeToContainerLog:function(t){this.$router.push({name:"containerLog",params:{id:t.id}})}}},dt={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"containers-list"},[n("section",{staticClass:"card"},[n("h3",{staticClass:"sub-title"},[t._v("Container 列表")]),t._v(" "),n("el-table",{staticStyle:{width:"100%"},attrs:{data:t.containersList}},[n("el-table-column",{attrs:{type:"selection"}}),t._v(" "),n("el-table-column",{attrs:{prop:"name",label:"Name","show-overflow-tooltip":!0}}),t._v(" "),n("el-table-column",{attrs:{prop:"state",label:"State",width:"120"}}),t._v(" "),n("el-table-column",{attrs:{prop:"stack",label:"Stack",width:"120"}}),t._v(" "),n("el-table-column",{attrs:{prop:"image",label:"Image","show-overflow-tooltip":!0,width:"240"}}),t._v(" "),n("el-table-column",{attrs:{prop:"created",label:"Created",width:"200"}}),t._v(" "),n("el-table-column",{attrs:{prop:"endpoint",label:"Endpoint","show-overflow-tooltip":!0,width:"180"}}),t._v(" "),n("el-table-column",{attrs:{label:"操作",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{attrs:{icon:"el-icon-document",type:"text",size:"small"},nativeOn:{click:function(n){return n.preventDefault(),t.routeToContainerLog(e.row)}}},[t._v("\n            日志\n          ")])]}}])})],1)],1)])},staticRenderFns:[]};var pt=n("VU/8")(lt,dt,!1,function(t){n("2PcU")},null,null).exports,mt={components:{},data:function(){return{servicesList:null}},mounted:function(){var t=this;return w()(_.a.mark(function e(){var n;return _.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,at();case 2:n=e.sent,t.servicesList=n.map(function(t){var e=void 0,n=void 0,r=void 0;return t.Spec.Mode&&t.Spec.Mode.Replicated?(e="replicated",n=t.Spec.Mode.Replicated.Replicas,r=(t.PreviousSpec,n)):e="global",{name:t.Spec.Name,stack:t.Spec.Labels["com.docker.stack.namespace"]||null,image:t.Spec.TaskTemplate.ContainerSpec.Image,ports:t.Endpoint.Spec.Ports||[],schedulingMode:t.Spec.Mode,updateTime:ut(new Date(t.UpdatedAt),"yyyy-MM-dd hh:mm:ss"),mode:e,replicas:n,preReplicas:r}});case 4:case"end":return e.stop()}},e,t)}))()},methods:{},filters:{}},ft={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"services-list"},[n("section",{staticClass:"card"},[n("h3",{staticClass:"sub-title"},[t._v("Service 列表")]),t._v(" "),n("el-table",{staticStyle:{width:"100%"},attrs:{data:t.servicesList}},[n("el-table-column",{attrs:{type:"selection"}}),t._v(" "),n("el-table-column",{attrs:{fixed:"",prop:"name",label:"Name","show-overflow-tooltip":!0}}),t._v(" "),n("el-table-column",{attrs:{prop:"stack",label:"Stack",width:"120"}}),t._v(" "),n("el-table-column",{attrs:{prop:"image",label:"Image","show-overflow-tooltip":!0,width:"240"}}),t._v(" "),n("el-table-column",{attrs:{label:"Ports"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("ul",{staticClass:"ports-list"},t._l(e.row.ports,function(e,r){return n("li",{key:r},[t._v("\n              "+t._s(e.TargetPort)+":"+t._s(e.PublishedPort)+"\n            ")])}),0)]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"schedulingMode",label:"Scheduling Mode",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("div",[t._v(t._s(e.row.mode)+"\n            "),"replicated"===e.row.mode?n("span",[t._v(t._s(e.row.preReplicas)+"/"+t._s(e.row.replicas))]):t._e()])]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"updateTime",label:"Last Update",width:"200"}})],1)],1)])},staticRenderFns:[]};var ht=n("VU/8")(mt,ft,!1,function(t){n("5o4V")},null,null).exports,vt={components:{},props:{},data:function(){return{stacksList:null}},mounted:function(){var t=this;return w()(_.a.mark(function e(){var n,r,a;return _.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,at();case 2:n=e.sent,r=[],a=!1,n.forEach(function(t){var e=t.Spec.Labels["com.docker.stack.namespace"];r.forEach(function(n){e===n.name&&(a=!0,n.services.push(t))}),!a&&e&&r.push({id:t.Id,name:e,services:[t],type:"swarm"})}),t.stacksList=r;case 7:case"end":return e.stop()}},e,t)}))()},methods:{routeToStackAnalysis:function(t){this.$router.push({name:"stackAnalysis",params:{id:t.name}})}}},bt={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"stacks-list"},[n("section",{staticClass:"card"},[n("h3",{staticClass:"sub-title"},[t._v("Stack 列表")]),t._v(" "),n("el-table",{staticStyle:{width:"100%"},attrs:{data:t.stacksList}},[n("el-table-column",{attrs:{type:"selection"}}),t._v(" "),n("el-table-column",{attrs:{fixed:"",prop:"name",label:"Name"}}),t._v(" "),n("el-table-column",{attrs:{prop:"type",label:"Type",width:"160"}}),t._v(" "),n("el-table-column",{attrs:{label:"Services",width:"320"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(e.row.services.length)+"\n        ")]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"操作",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{attrs:{icon:"el-icon-document",type:"text",size:"small"},nativeOn:{click:function(n){return n.preventDefault(),t.routeToStackAnalysis(e.row)}}},[t._v("\n            依赖分析\n          ")])]}}])})],1)],1)])},staticRenderFns:[]};var gt=n("VU/8")(vt,bt,!1,function(t){n("LDM6")},null,null).exports,_t=function(){var t=w()(_.a.mark(function t(){var e;arguments.length>0&&void 0!==arguments[0]&&arguments[0];return _.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,R.get("/endpoint/"+j()+"/docker/nodes");case 2:if(200!==(e=t.sent).data.code){t.next=5;break}return t.abrupt("return",e.data.data);case 5:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),kt=function(){var t=w()(_.a.mark(function t(){var e;arguments.length>0&&void 0!==arguments[0]&&arguments[0];return _.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,R.get("/endpoint/"+j()+"/docker/swarm");case 2:if(200!==(e=t.sent).data.code){t.next=5;break}return t.abrupt("return",e.data.data);case 5:return t.abrupt("return",null);case 6:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),wt=function(){var t=w()(_.a.mark(function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return _.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,R({method:"POST",url:"/endpoint/"+j()+"/docker/swarm/init",data:{ListenAddr:"0.0.0.0:2377",AdvertiseAddr:n.ip}});case 2:if(200===(e=t.sent).data.code){t.next=5;break}return t.abrupt("return",e.data.message);case 5:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),yt=function(){var t=w()(_.a.mark(function t(e){return _.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,R({method:"POST",url:"/proxy/docker/swarm/leave?force=1",data:{proxyTargetIp:e}});case 2:if(200===t.sent.data.code){t.next=5;break}return t.abrupt("return","删除节点失败");case 5:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),xt=function(){var t=w()(_.a.mark(function t(e,n,r){var a;return _.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,R({method:"POST",url:"/proxy/docker/swarm/join",data:{proxyTargetIp:e,ListenAddr:"0.0.0.0:2377",RemoteAddrs:[r+":2377"],JoinToken:n}});case 2:if(200===(a=t.sent).data.code){t.next=5;break}return t.abrupt("return",a.data.message);case 5:case"end":return t.stop()}},t,this)}));return function(e,n,r){return t.apply(this,arguments)}}(),Ct={components:{},data:function(){return{nodesList:null,swarmInfo:null,nodeSelection:[],currentEndpoint:null,dialogVisible:!1,joinFormInfo:{isManager:!1,ip:""},endpointList:[]}},computed:{managerNodes:function(){return this.nodesList.filter(function(t){return"manager"===t.role})}},mounted:function(){var t=this;return w()(_.a.mark(function e(){var n,r;return _.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P();case 2:return(n=e.sent).ip=n.dockerUrl.split(":")[0],t.currentEndpoint=n,e.next=7,H();case 7:(r=e.sent).forEach(function(t){t.ip=t.dockerUrl.split(":")[0]}),t.endpointList=r,t.fetchSwarmInfo();case 11:case"end":return e.stop()}},e,t)}))()},methods:{fetchSwarmInfo:function(){var t=this;return w()(_.a.mark(function e(){var n,r;return _.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,kt();case 2:if(n=e.sent,t.swarmInfo=n,n){e.next=7;break}return t.nodesList=[],e.abrupt("return");case 7:return e.next=9,_t();case 9:r=e.sent,t.nodesList=r.map(function(t){return{name:t.Description.Hostname,role:t.Spec.Role,nanoCPUs:t.Description.Resources.NanoCPUs,engine:t.Description.Engine.EngineVersion,address:t.Status.Addr,status:t.Status.State}});case 11:case"end":return e.stop()}},e,t)}))()},handleSelectionChange:function(t){this.nodeSelection=t},createSwarm:function(){var t=this;return w()(_.a.mark(function e(){var n;return _.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,wt(t.currentEndpoint);case 2:(n=e.sent)?t.$message.error(n):(t.$message.success("集群创建成功"),t.fetchSwarmInfo());case 4:case"end":return e.stop()}},e,t)}))()},leaveSwarm:function(){var t=this;return w()(_.a.mark(function e(){var n;return _.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n="",t.nodeSelection.forEach(function(){var e=w()(_.a.mark(function e(r){var a;return _.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,yt(r.address);case 2:(a=t.sent)&&(n+=a);case 4:case"end":return t.stop()}},e,t)}));return function(t){return e.apply(this,arguments)}}()),""===n?(t.$message.success("集群节点删除成功"),t.fetchSwarmInfo()):t.$message.error(n);case 3:case"end":return e.stop()}},e,t)}))()},joinSwarm:function(){var t=this;return w()(_.a.mark(function e(){var n,r,a;return _.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.joinFormInfo.isManager?"Manager":"Worker",r=t.swarmInfo.JoinTokens[n],console.log("joinSwarm",t.currentEndpoint.ip,r,t.managerNodes[0].address),e.next=5,xt(t.joinFormInfo.ip,r,t.managerNodes[0].address);case 5:(a=e.sent)?t.$message.error(a):(t.$message.success("节点加入集群"),t.fetchSwarmInfo(),t.dialogVisible=!1);case 7:case"end":return e.stop()}},e,t)}))()},querySearch:function(t,e){var n=[];(t?this.endpointList.filter(function(e){return 0===e.ip.indexOf(t)}):this.endpointList).forEach(function(t){n.includes(t.ip)||n.push({value:t.ip})}),console.log("results",n),e(n)},handleSelect:function(t){console.log("click",t.value),this.joinFormInfo.ip=t.value}}},St={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"nodes-list"},[n("section",{staticClass:"card"},[n("h3",{staticClass:"sub-title"},[t._v("Node 列表")]),t._v(" "),n("div",{staticClass:"action-bar"},[t.swarmInfo?t._e():n("el-button",{attrs:{type:"primary"},on:{click:t.createSwarm}},[t._v("\n        创建swarm集群\n      ")]),t._v(" "),t.swarmInfo?n("el-button",{attrs:{type:"primary",disabled:t.nodeSelection.length<1},on:{click:t.leaveSwarm}},[t._v("\n        删除swarm节点\n      ")]):t._e(),t._v(" "),t.swarmInfo?n("el-button",{attrs:{type:"primary"},on:{click:function(e){t.dialogVisible=!0}}},[t._v("\n        添加swarm节点\n      ")]):t._e()],1),t._v(" "),n("el-dialog",{attrs:{title:"添加swarm节点",visible:t.dialogVisible,width:"60%"},on:{"update:visible":function(e){t.dialogVisible=e}}},[n("el-form",{ref:"form",attrs:{model:t.joinFormInfo,"label-width":"180px"}},[n("el-form-item",{attrs:{label:"作为管理节点"}},[n("el-switch",{model:{value:t.joinFormInfo.isManager,callback:function(e){t.$set(t.joinFormInfo,"isManager",e)},expression:"joinFormInfo.isManager"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"IP"}},[n("el-autocomplete",{attrs:{"fetch-suggestions":t.querySearch,placeholder:"新增节点Ip"},on:{select:t.handleSelect},model:{value:t.joinFormInfo.ip,callback:function(e){t.$set(t.joinFormInfo,"ip",e)},expression:"joinFormInfo.ip"}})],1)],1),t._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),t._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:t.joinSwarm}},[t._v("确 定")])],1)],1),t._v(" "),n("el-table",{staticStyle:{width:"100%"},attrs:{data:t.nodesList},on:{"selection-change":t.handleSelectionChange}},[n("el-table-column",{attrs:{type:"selection"}}),t._v(" "),n("el-table-column",{attrs:{prop:"name",label:"Name","show-overflow-tooltip":!0}}),t._v(" "),n("el-table-column",{attrs:{prop:"role",label:"Role",width:"160"}}),t._v(" "),n("el-table-column",{attrs:{prop:"nanoCPUs",label:"Nano CPUs",width:"200"}}),t._v(" "),n("el-table-column",{attrs:{prop:"engine",label:"Engine",width:"160"}}),t._v(" "),n("el-table-column",{attrs:{prop:"address",label:"IP Address",width:"180"}}),t._v(" "),n("el-table-column",{attrs:{prop:"status",label:"Status",width:"180"}})],1)],1)])},staticRenderFns:[]};var It=n("VU/8")(Ct,St,!1,function(t){n("RaZw")},null,null).exports,Ut=function(){var t=w()(_.a.mark(function t(){var e,n,r,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return _.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return(e={query:{bool:{must:[{term:{_type:"fluentd-docker"}}]}}}).query.bool.must=e.query.bool.must.concat(a),t.next=4,R({method:"POST",url:"/elastic/_search",data:e});case 4:if(200===(n=t.sent).data.code){t.next=7;break}return t.abrupt("return");case 7:if(r=n.data.data.hits.hits,s){t.next=10;break}return t.abrupt("return",r);case 10:return t.abrupt("return",r.map(function(t){return X(t)}));case 11:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),Et={components:{},props:{},data:function(){return{logList:null,datetimeRange:null}},computed:{},filters:{timeFormat:function(t){var e=t;return"string"==typeof t&&(e=new Date(t)),ut(e,"yyyy-MM-dd hh:mm:ss")}},mounted:function(){var t=this;return w()(_.a.mark(function e(){return _.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ut([{term:{container_id:t.$route.params.id}}],!0);case 2:t.logList=e.sent;case 3:case"end":return e.stop()}},e,t)}))()},methods:{handleDatetimeChange:function(){var t=this;return w()(_.a.mark(function e(){return _.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.datetimeRange){e.next=6;break}return e.next=3,Ut([{term:{container_id:t.$route.params.id}}],!0);case 3:t.logList=e.sent,e.next=9;break;case 6:return e.next=8,Ut([{term:{container_id:t.$route.params.id}},{range:{"@timestamp":{lt:t.datetimeRange[1],gte:t.datetimeRange[0]}}}],!0);case 8:t.logList=e.sent;case 9:case"end":return e.stop()}},e,t)}))()}}},Dt={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container-log"},[n("section",{staticClass:"card"},[n("h3",{staticClass:"sub-title"},[t._v("容器日志")]),t._v(" "),n("el-date-picker",{attrs:{type:"datetimerange","start-placeholder":"起始日期","end-placeholder":"结束日期","default-time":["12:00:00"]},on:{change:t.handleDatetimeChange},model:{value:t.datetimeRange,callback:function(e){t.datetimeRange=e},expression:"datetimeRange"}}),t._v(" "),n("el-table",{staticStyle:{width:"100%","margin-top":"8px"},attrs:{data:t.logList}},[n("el-table-column",{attrs:{type:"expand"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-form",{staticClass:"table-expand",attrs:{"label-position":"left"}},t._l(e.row,function(e,r){return n("el-form-item",{key:r,attrs:{label:r,"label-width":"280px"}},[n("span",[t._v(t._s(e))])])}),1)]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"ID",prop:"_id"}}),t._v(" "),n("el-table-column",{attrs:{label:"Index",prop:"_index"}}),t._v(" "),n("el-table-column",{attrs:{label:"Timestamp"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(t._f("timeFormat")(e.row["_source.@timestamp"]))+"\n        ")]}}])})],1)],1)])},staticRenderFns:[]};var Lt=n("VU/8")(Et,Dt,!1,function(t){n("dyd0")},null,null).exports,Mt=n("E5Az"),$t=(n("4/hK"),n("jGSh"),n("uqUb"),n("NVob")),At=n.n($t),Ft=n("XLwt"),Ot=n.n(Ft),Rt={props:["graphData"],data:function(){return{chart:null,option:{tooltip:{},animationDuration:1500,animationEasingUpdate:"quinticInOut",series:[{type:"graph",layout:"circular",data:this.graphData.nodes||[],links:this.graphData.links||[],roam:!0,focusNodeAdjacency:!0,itemStyle:{normal:{color:function(t){return["#BF2C33","#63A1B5","#D28065","#93C9AE","#27727B","#75A183","#C98624","#BCA29A","#6E7470","#304554","#4682B4","#800000","#BC8F8F","#BDB76B","#008B8B"][t.dataIndex]},borderColor:"#fff",borderWidth:1,shadowBlur:10,shadowColor:"rgba(0, 0, 0, 0.14)"}},label:{position:"right",formatter:"{b}",show:!0},edgeSymbol:["none","arrow"],lineStyle:{color:"source",curveness:.3,opacity:.5,width:1.8},emphasis:{lineStyle:{width:2.6}}}]}}},mounted:function(){this.chart=Ot.a.init(this.$refs.seriesGraph),this.chart.setOption(this.option)},watch:{graphData:function(t){var e=this.option.series[0];e.data=t.nodes||[],e.links=t.links||[],this.chart||(this.chart=Ot.a.init(this.$refs.seriesGraph)),this.chart.setOption(this.option)}}},Tt={render:function(){var t=this.$createElement;return(this._self._c||t)("div",{ref:"seriesGraph",staticClass:"series-graph",attrs:{id:"seriesGraph"}})},staticRenderFns:[]};var Nt=n("VU/8")(Rt,Tt,!1,function(t){n("h3XF")},null,null).exports,Pt=function(){var t=w()(_.a.mark(function t(e){var n;return _.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,R.get("/compose/"+e);case 2:if(200!==(n=t.sent).data.code){t.next=5;break}return t.abrupt("return",n.data.data);case 5:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),Ht=function(){var t=w()(_.a.mark(function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return _.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,R({method:"PUT",url:"/compose",data:n});case 2:if(200===(e=t.sent).data.code){t.next=5;break}return t.abrupt("return",e.data.message);case 5:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),Bt=function(){var t=w()(_.a.mark(function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return _.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,R({method:"POST",url:"/compose",data:n});case 2:if(200===(e=t.sent).data.code){t.next=5;break}return t.abrupt("return",e.data.message);case 5:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),jt={components:{codemirror:Mt.codemirror,SeriesGraph:Nt},props:{},data:function(){return{sourceDockerCompose:null,code:"",cmOptions:{tabSize:2,mode:"yaml",theme:"base16-dark",styleActiveLine:!0,showCursorWhenSelecting:!0,lineNumbers:!0,line:!0}}},computed:{initYmlObject:function(){return At.a.load(this.sourceDockerCompose.content)},ymlUpdatable:function(){return this.ymlObject&&!this._.isEqual(this.initYmlObject,this.ymlObject)},ymlObject:function(){try{return At.a.load(this.code)}catch(t){return null}},services:function(){return this.ymlObject&&this.ymlObject.services},graphData:function(){var t=this,e=[],n=[];if(this.services){var r=function(r){var a=t.services[r];e.push({id:r,name:r,value:50,symbolSize:50}),a&&Array.isArray(a.depends_on)&&a.depends_on.forEach(function(t){n.push({source:r,target:t})})};for(var a in this.services)r(a)}return{nodes:e,links:n}},stackId:function(){return this.$route.params.id}},mounted:function(){var t=this;return w()(_.a.mark(function e(){return _.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Pt(t.stackId);case 2:t.sourceDockerCompose=e.sent,t.sourceDockerCompose&&(t.code=t.sourceDockerCompose.content);case 4:case"end":return e.stop()}},e,t)}))()},methods:{createDockerCompose:function(){var t=this;return w()(_.a.mark(function e(){var n,r;return _.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n={id:t.stackId,name:t.stackId,stackId:t.stackId,isStackDependOn:!1,content:t.code},e.next=3,Bt(n);case 3:(r=e.sent)?t.$message.error(r):(t.$message.success("DockerCompose创建成功"),t.sourceDockerCompose=n);case 5:case"end":return e.stop()}},e,t)}))()},updateDockerCompose:function(){var t=this;return w()(_.a.mark(function e(){var n,r;return _.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.sourceDockerCompose,t.ymlObject){e.next=3;break}return e.abrupt("return");case 3:return n.content=t.code,e.next=6,Ht(n);case 6:(r=e.sent)?t.$message.error(r):(t.$message.success("DockerCompose更新成功"),t.sourceDockerCompose=n);case 8:case"end":return e.stop()}},e,t)}))()}}},Wt={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"stack-analysis"},[n("section",{staticClass:"card"},[n("h3",{staticClass:"sub-title"},[t._v("依赖分析")]),t._v(" "),t.sourceDockerCompose?t._e():n("el-button",{staticStyle:{"margin-bottom":"12px"},attrs:{type:"primary",disabled:!t.code},on:{click:t.createDockerCompose}},[t._v("\n      创建Docker-Compose\n    ")]),t._v(" "),t.sourceDockerCompose?n("el-button",{staticStyle:{"margin-bottom":"12px"},attrs:{type:"primary",disabled:!t.ymlUpdatable},on:{click:t.updateDockerCompose}},[t._v("\n      更新Docker-Compose\n    ")]):t._e(),t._v(" "),n("div",{staticClass:"depend-analysis"},[n("div",{staticClass:"depend-code-wraper"},[n("codemirror",{staticClass:"depend-code",attrs:{options:t.cmOptions},model:{value:t.code,callback:function(e){t.code=e},expression:"code"}})],1),t._v(" "),n("div"),t._v(" "),n("div",{staticClass:"depend-chart-wraper"},[n("series-graph",{attrs:{graphData:t.graphData}})],1)])],1)])},staticRenderFns:[]};var Vt=n("VU/8")(jt,Wt,!1,function(t){n("17DS")},null,null).exports;s.default.use(m.a);var qt=new m.a({routes:[{path:"/",redirect:"/home"},{path:"/home",name:"home",component:ct},{path:"/containers",name:"containersList",component:pt},{path:"/services",name:"servicesList",component:ht},{path:"/stacks",name:"stacksList",component:gt},{path:"/swarm",name:"nodesList",component:It},{path:"/containers/:id/log",name:"containerLog",component:Lt},{path:"/stack/:id/analysis",name:"stackAnalysis",component:Vt}]}),zt=n("rdLu"),Gt=n.n(zt);n("tvR6");s.default.use(a.a),s.default.prototype._=Gt.a,new s.default({el:"#app",router:qt,components:{Layout:p},template:"<layout/>"})},RaZw:function(t,e){},VHhA:function(t,e){},XQ4a:function(t,e){},"Z/q7":function(t,e){},dyd0:function(t,e){},h3XF:function(t,e){},jGSh:function(t,e){},q6Q7:function(t,e){},tvR6:function(t,e){},zlJl:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.dc155fa86ff6d3b0f8ca.js.map